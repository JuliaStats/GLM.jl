<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · GLM</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>GLM</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Fitting-GLM-models"><span>Fitting GLM models</span></a></li><li><a class="tocitem" href="#Categorical-variables"><span>Categorical variables</span></a></li><li><a class="tocitem" href="#Comparing-models-with-F-test"><span>Comparing models with F-test</span></a></li><li><a class="tocitem" href="#Methods-applied-to-fitted-models"><span>Methods applied to fitted models</span></a></li><li><a class="tocitem" href="#Separation-of-response-object-and-predictor-object"><span>Separation of response object and predictor object</span></a></li></ul></li><li><a class="tocitem" href="examples/">Examples</a></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaStats/GLM.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="GLM.jl-Manual"><a class="docs-heading-anchor" href="#GLM.jl-Manual">GLM.jl Manual</a><a id="GLM.jl-Manual-1"></a><a class="docs-heading-anchor-permalink" href="#GLM.jl-Manual" title="Permalink"></a></h1><p>Linear and generalized linear models in Julia</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><pre><code class="language-julia hljs">Pkg.add(&quot;GLM&quot;)</code></pre><p>will install this package and its dependencies, which includes the <a href="https://github.com/JuliaStats/Distributions.jl">Distributions package</a>.</p><p>The <a href="https://github.com/johnmyleswhite/RDatasets.jl">RDatasets package</a> is useful for fitting models on standard R datasets to compare the results with those from R.</p><h2 id="Fitting-GLM-models"><a class="docs-heading-anchor" href="#Fitting-GLM-models">Fitting GLM models</a><a id="Fitting-GLM-models-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-GLM-models" title="Permalink"></a></h2><p>Two methods can be used to fit a Generalized Linear Model (GLM): <code>glm(formula, data, family, link)</code> and <code>glm(X, y, family, link)</code>. Their arguments must be:</p><ul><li><code>formula</code>: a <a href="https://juliastats.org/StatsModels.jl/stable/formula/">StatsModels.jl <code>Formula</code> object</a> referring to columns in <code>data</code>; for example, if column names are <code>:Y</code>, <code>:X1</code>, and <code>:X2</code>, then a valid formula is <code>@formula(Y ~ X1 + X2)</code></li><li><code>data</code>: a table in the Tables.jl definition, e.g. a data frame; rows with <code>missing</code> values are ignored</li><li><code>X</code> a matrix holding values of the independent variable(s) in columns</li><li><code>y</code> a vector holding values of the dependent variable (including if appropriate the intercept)</li><li><code>family</code>: chosen from <code>Bernoulli()</code>, <code>Binomial()</code>, <code>Gamma()</code>, <code>Geometric()</code>, <code>Normal()</code>, <code>Poisson()</code>, or <code>NegativeBinomial(θ)</code></li><li><code>link</code>: chosen from the list below, for example, <code>LogitLink()</code> is a valid link for the <code>Binomial()</code> family</li></ul><p>Typical distributions for use with <code>glm</code> and their canonical link functions are</p><pre><code class="nohighlight hljs">       Bernoulli (LogitLink)
        Binomial (LogitLink)
           Gamma (InverseLink)
       Geometric (LogLink)
 InverseGaussian (InverseSquareLink)
NegativeBinomial (NegativeBinomialLink, often used with LogLink)
          Normal (IdentityLink)
         Poisson (LogLink)</code></pre><p>Currently the available Link types are</p><pre><code class="nohighlight hljs">CauchitLink
CloglogLink
IdentityLink
InverseLink
InverseSquareLink
LogitLink
LogLink
NegativeBinomialLink
PowerLink
ProbitLink
SqrtLink</code></pre><p>Note that the canonical link for negative binomial regression is <code>NegativeBinomialLink</code>, but in practice one typically uses <code>LogLink</code>. The <code>NegativeBinomial</code> distribution belongs to the exponential family only if θ (the shape parameter) is fixed, thus θ has to be provided if we use <code>glm</code> with <code>NegativeBinomial</code> family. If one would like to also estimate θ, then <code>negbin(formula, data, link)</code> should be used instead.</p><p>An intercept is included in any GLM by default.</p><h2 id="Categorical-variables"><a class="docs-heading-anchor" href="#Categorical-variables">Categorical variables</a><a id="Categorical-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Categorical-variables" title="Permalink"></a></h2><p>Categorical variables will be dummy coded by default if they are non-numeric or if they are <a href="https://juliadata.github.io/CategoricalArrays.jl/stable/"><code>CategoricalVector</code>s</a> within a <a href="https://juliadata.github.io/Tables.jl/stable/">Tables.jl</a> table (<code>DataFrame</code>, JuliaDB table, named tuple of vectors, etc). Alternatively, you can pass an explicit <a href="https://juliastats.github.io/StatsModels.jl/stable/contrasts/">contrasts</a> argument if you would like a different contrast coding system or if you are not using DataFrames.</p><p>The response (dependent) variable may not be categorical.</p><p>Using a <code>CategoricalVector</code> constructed with <code>categorical</code> or <code>categorical!</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; using CategoricalArrays, DataFrames, GLM, StableRNGs

julia&gt; rng = StableRNG(1); # Ensure example can be reproduced

julia&gt; data = DataFrame(y = rand(rng, 100), x = categorical(repeat([1, 2, 3, 4], 25)));


julia&gt; lm(@formula(y ~ x), data)
StatsModels.TableRegressionModel{LinearModel{GLM.LmResp{Vector{Float64}}, GLM.DensePredChol{Float64, LinearAlgebra.CholeskyPivoted{Float64, Matrix{Float64}, Vector{Int64}}}}, Matrix{Float64}}

y ~ 1 + x

Coefficients:
───────────────────────────────────────────────────────────────────────────
                  Coef.  Std. Error      t  Pr(&gt;|t|)   Lower 95%  Upper 95%
───────────────────────────────────────────────────────────────────────────
(Intercept)   0.490985    0.0564176   8.70    &lt;1e-13   0.378997    0.602973
x: 2          0.0527655   0.0797865   0.66    0.5100  -0.105609    0.21114
x: 3          0.0955446   0.0797865   1.20    0.2341  -0.0628303   0.25392
x: 4         -0.032673    0.0797865  -0.41    0.6831  -0.191048    0.125702
───────────────────────────────────────────────────────────────────────────</code></pre><p>Using <a href="https://juliastats.github.io/StatsModels.jl/stable/contrasts/"><code>contrasts</code></a>:</p><pre><code class="language-julia-repl hljs">julia&gt; using StableRNGs

julia&gt; data = DataFrame(y = rand(StableRNG(1), 100), x = repeat([1, 2, 3, 4], 25));

julia&gt; lm(@formula(y ~ x), data, contrasts = Dict(:x =&gt; DummyCoding()))
StatsModels.TableRegressionModel{LinearModel{GLM.LmResp{Vector{Float64}}, GLM.DensePredChol{Float64, LinearAlgebra.CholeskyPivoted{Float64, Matrix{Float64}, Vector{Int64}}}}, Matrix{Float64}}

y ~ 1 + x

Coefficients:
───────────────────────────────────────────────────────────────────────────
                  Coef.  Std. Error      t  Pr(&gt;|t|)   Lower 95%  Upper 95%
───────────────────────────────────────────────────────────────────────────
(Intercept)   0.490985    0.0564176   8.70    &lt;1e-13   0.378997    0.602973
x: 2          0.0527655   0.0797865   0.66    0.5100  -0.105609    0.21114
x: 3          0.0955446   0.0797865   1.20    0.2341  -0.0628303   0.25392
x: 4         -0.032673    0.0797865  -0.41    0.6831  -0.191048    0.125702
───────────────────────────────────────────────────────────────────────────</code></pre><h2 id="Comparing-models-with-F-test"><a class="docs-heading-anchor" href="#Comparing-models-with-F-test">Comparing models with F-test</a><a id="Comparing-models-with-F-test-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-models-with-F-test" title="Permalink"></a></h2><p>Comparisons between two or more linear models can be performed using the <code>ftest</code> function, which computes an F-test between each pair of subsequent models and reports fit statistics:</p><pre><code class="language-julia-repl hljs">julia&gt; using DataFrames, GLM, StableRNGs

julia&gt; data = DataFrame(y = (1:50).^2 .+ randn(StableRNG(1), 50), x = 1:50);

julia&gt; ols_lin = lm(@formula(y ~ x), data);

julia&gt; ols_sq = lm(@formula(y ~ x + x^2), data);

julia&gt; ftest(ols_lin.model, ols_sq.model)
F-test: 2 models fitted on 50 observations
─────────────────────────────────────────────────────────────────────────────────
     DOF  ΔDOF           SSR           ΔSSR      R²     ΔR²            F*   p(&gt;F)
─────────────────────────────────────────────────────────────────────────────────
[1]    3        1731979.2266                 0.9399
[2]    4     1       40.7581  -1731938.4685  1.0000  0.0601  1997177.0357  &lt;1e-99
─────────────────────────────────────────────────────────────────────────────────</code></pre><h2 id="Methods-applied-to-fitted-models"><a class="docs-heading-anchor" href="#Methods-applied-to-fitted-models">Methods applied to fitted models</a><a id="Methods-applied-to-fitted-models-1"></a><a class="docs-heading-anchor-permalink" href="#Methods-applied-to-fitted-models" title="Permalink"></a></h2><p>Many of the methods provided by this package have names similar to those in <a href="http://www.r-project.org">R</a>.</p><ul><li><code>adjr2</code>: adjusted R² for a linear model (an alias for <code>adjr²</code>)</li><li><code>aic</code>: Akaike&#39;s Information Criterion</li><li><code>aicc</code>: corrected Akaike&#39;s Information Criterion for small sample sizes</li><li><code>bic</code>: Bayesian Information Criterion</li><li><code>coef</code>: estimates of the coefficients in the model</li><li><code>confint</code>: confidence intervals for coefficients</li><li><code>cooksdistance</code>: <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cook&#39;s distance</a> for each observation</li><li><code>deviance</code>: measure of the model fit, weighted residual sum of squares for lm&#39;s</li><li><code>dispersion</code>: dispersion (or scale) parameter for a model&#39;s distribution</li><li><code>dof</code>: number of degrees of freedom consumed in the model</li><li><code>dof_residual</code>: degrees of freedom for residuals, when meaningful</li><li><code>fitted</code>: fitted values of the model</li><li><code>glm</code>: fit a generalized linear model (an alias for <code>fit(GeneralizedLinearModel, ...)</code>)</li><li><code>lm</code>: fit a linear model (an alias for <code>fit(LinearModel, ...)</code>)</li><li><code>loglikelihood</code>: log-likelihood of the model</li><li><code>modelmatrix</code>: design matrix</li><li><code>nobs</code>: number of rows, or sum of the weights when prior weights are specified</li><li><code>nulldeviance</code>: deviance of the model with all predictors removed</li><li><code>nullloglikelihood</code>: log-likelihood of the model with all predictors removed</li><li><code>predict</code>: predicted values of the dependent variable from the fitted model</li><li><code>r2</code>: R² of a linear model (an alias for <code>r²</code>)</li><li><code>residuals</code>: vector of residuals from the fitted model</li><li><code>response</code>: model response (a.k.a the dependent variable)</li><li><code>stderror</code>: standard errors of the coefficients</li><li><code>vcov</code>: variance-covariance matrix of the coefficient estimates</li></ul><p>Note that the canonical link for negative binomial regression is <code>NegativeBinomialLink</code>, but in practice one typically uses <code>LogLink</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; using GLM, DataFrames, StatsBase

julia&gt; data = DataFrame(X=[1,2,3], y=[2,4,7]);

julia&gt; mdl = lm(@formula(y ~ X), data);

julia&gt; round.(coef(mdl); digits=8)
2-element Vector{Float64}:
 -0.66666667
  2.5

julia&gt; round(r2(mdl); digits=8)
0.98684211

julia&gt; round(aic(mdl); digits=8)
5.84251593</code></pre><p>The <a href="api/#StatsAPI.predict"><code>predict</code></a> method returns predicted values of response variable from covariate values in an input <code>newX</code>. If <code>newX</code> is omitted then the fitted response values from the model are returned.</p><pre><code class="language-julia-repl hljs">julia&gt; test_data = DataFrame(X=[4]);

julia&gt; round.(predict(mdl, test_data); digits=8)
1-element Vector{Float64}:
 9.33333333</code></pre><p>The <a href="@ref"><code>cooksdistance</code></a> method computes <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cook&#39;s distance</a> for each observation used to fit a linear model, giving an estimate of the influence of each data point. Note that it&#39;s currently only implemented for linear models without weights.</p><pre><code class="language-julia-repl hljs">julia&gt; round.(cooksdistance(mdl); digits=8)
3-element Vector{Float64}:
 2.5
 0.25
 2.5</code></pre><h2 id="Separation-of-response-object-and-predictor-object"><a class="docs-heading-anchor" href="#Separation-of-response-object-and-predictor-object">Separation of response object and predictor object</a><a id="Separation-of-response-object-and-predictor-object-1"></a><a class="docs-heading-anchor-permalink" href="#Separation-of-response-object-and-predictor-object" title="Permalink"></a></h2><p>The general approach in this code is to separate functionality related to the response from that related to the linear predictor.  This allows for greater generality by mixing and matching different subtypes of the abstract type <code>LinPred</code> and the abstract type <code>ModResp</code>.</p><p>A <code>LinPred</code> type incorporates the parameter vector and the model matrix.  The parameter vector is a dense numeric vector but the model matrix can be dense or sparse.  A <code>LinPred</code> type must incorporate some form of a decomposition of the weighted model matrix that allows for the solution of a system <code>X&#39;W * X * delta=X&#39;wres</code> where <code>W</code> is a diagonal matrix of &quot;X weights&quot;, provided as a vector of the square roots of the diagonal elements, and <code>wres</code> is a weighted residual vector.</p><p>Currently there are two dense predictor types, <code>DensePredQR</code> and <code>DensePredChol</code>, and the usual caveats apply.  The Cholesky version is faster but somewhat less accurate than that QR version. The skeleton of a distributed predictor type is in the code but not yet fully fleshed out.  Because Julia by default uses OpenBLAS, which is already multi-threaded on multicore machines, there may not be much advantage in using distributed predictor types.</p><p>A <code>ModResp</code> type must provide methods for the <code>wtres</code> and <code>sqrtxwts</code> generics.  Their values are the arguments to the <code>updatebeta</code> methods of the <code>LinPred</code> types.  The <code>Float64</code> value returned by <code>updatedelta</code> is the value of the convergence criterion.</p><p>Similarly, <code>LinPred</code> types must provide a method for the <code>linpred</code> generic.  In general <code>linpred</code> takes an instance of a <code>LinPred</code> type and a step factor.  Methods that take only an instance of a <code>LinPred</code> type use a default step factor of 1.  The value of <code>linpred</code> is the argument to the <code>updatemu</code> method for <code>ModResp</code> types.  The <code>updatemu</code> method returns the updated deviance.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 14 September 2023 15:09">Thursday 14 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
